---
title: blogdownを使う時はlocaleに注意
author: ~
date: '2018-08-01'
slug: setlocale
categories: [R]
tags: [R, blogdown] 
---

# blogdown記事の公開日について

blogdownで作成する記事は、以下のように公開日をyamlで指定します。  
`blogdown::new_post()` を用いると、記事作成日がそのまま公開日として入力されるため、あまり意識することはないかもしれません。

```yaml
---
date: 2018-08-01
---
```

`---` の間には他にも `title` や `author` などのメタデータを入力できます。

記事の更新の度に公開日を改めたい場合は、

```yaml
---
data: `r Sys.Date()`
---
```

としておいてもいいでしょう。

また、ここで未来の日付けを入力しておくと、
`serve_site()` によるローカルプレビューでは記事が見えるものの、
`build_site()` しても記事はただちに公開されません。  
公開日以降に `build_site()` すると、公開できるようになります。

# なぜか今日の投稿が未来へ

公開日をうまく活用するとblogライフが捗りますね。  
しかし、誤ると……。

自分の場合、記事を投稿してもbuildされない悪夢にうなされました。  
しかし後日挑戦すると、過去の記事はbuildされ、新記事はbuildされない。  
なぜだ……と。  
公開日は `new_post()` による自動設定から変えていないのに……。

## 解決 (ロケールを設定)

自分の場合、Linux Mintを英語環境で動かしていたので、その辺りにカラクリがあるのではと検討をつけました。

.Rprofileに

```r
Sys.setlocale(locale = 'ja_JP.UTF-8')
```

を追記とすることで正常に記事が処理されるように!!

ちなみに、localeを変えても `date()` の返り値は変わりません。
blogdownのナゾ挙動に触れてしまいました。

### 規定のlocale で `date()`

```{r}
Sys.setlocale()
date()
```

### 日本のlocale で `date()`

```{r}
Sys.setlocale(locale = 'ja_JP.UTF-8')
date()
```

